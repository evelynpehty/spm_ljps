{"version":3,"file":"loading-button.js","sources":["../src/loading-button.js"],"sourcesContent":["/**\n * --------------------------------------------------------------------------\n * CoreUI PRO (v4.3.4): loading-button.js\n * License (https://coreui.io/pro/license-new/)\n * --------------------------------------------------------------------------\n */\n\nimport { defineJQueryPlugin } from './util/index'\nimport Data from './dom/data'\nimport EventHandler from './dom/event-handler'\nimport Manipulator from './dom/manipulator'\nimport BaseComponent from './base-component'\n\n/**\n * ------------------------------------------------------------------------\n * Constants\n * ------------------------------------------------------------------------\n */\n\nconst NAME = 'loading-button'\nconst DATA_KEY = 'coreui.loading-button'\nconst EVENT_KEY = `.${DATA_KEY}`\n\nconst EVENT_START = `start${EVENT_KEY}`\nconst EVENT_STOP = `stop${EVENT_KEY}`\n\nconst CLASS_NAME_IS_LOADING = 'is-loading'\nconst CLASS_NAME_LOADING_BUTTON_SPINNER = 'btn-loading-spinner'\n\nconst Default = {\n  disabledOnLoading: false,\n  spinner: true,\n  spinnerType: 'border',\n  timeout: false\n}\n\nconst DefaultType = {\n  disabledOnLoading: 'boolean',\n  spinner: 'boolean',\n  spinnerType: 'string',\n  timeout: '(boolean|number)'\n}\n\n/**\n * ------------------------------------------------------------------------\n * Class Definition\n * ------------------------------------------------------------------------\n */\n\nclass LoadingButton extends BaseComponent {\n  constructor(element, config) {\n    super(element)\n\n    this._config = this._getConfig(config)\n    this._timeout = this._config.timeout\n    this._spinner = null\n    this._state = 'idle'\n\n    if (this._element) {\n      Data.set(element, DATA_KEY, this)\n    }\n  }\n\n  // Getters\n\n  static get Default() {\n    return Default\n  }\n\n  static get DefaultType() {\n    return DefaultType\n  }\n\n  static get DATA_KEY() {\n    return DATA_KEY\n  }\n\n  static get NAME() {\n    return NAME\n  }\n\n  // Public\n\n  start() {\n    if (this._state !== 'loading') {\n      this._createSpinner()\n      this._state = 'loading'\n\n      setTimeout(() => {\n        this._element.classList.add(CLASS_NAME_IS_LOADING)\n        EventHandler.trigger(this._element, EVENT_START)\n\n        if (this._config.disabledOnLoading) {\n          this._element.setAttribute('disabled', true)\n        }\n      }, 1)\n\n      if (this._config.timeout) {\n        setTimeout(() => {\n          this.stop()\n        }, this._config.timeout)\n      }\n    }\n  }\n\n  stop() {\n    this._element.classList.remove(CLASS_NAME_IS_LOADING)\n    const stoped = () => {\n      this._removeSpinner()\n      this._state = 'idle'\n\n      if (this._config.disabledOnLoading) {\n        this._element.removeAttribute('disabled')\n      }\n\n      EventHandler.trigger(this._element, EVENT_STOP)\n    }\n\n    if (this._spinner) {\n      this._queueCallback(stoped, this._spinner, true)\n      return\n    }\n\n    stoped()\n  }\n\n  dispose() {\n    Data.removeData(this._element, DATA_KEY)\n    this._element = null\n  }\n\n  _getConfig(config) {\n    config = {\n      ...Default,\n      ...Manipulator.getDataAttributes(this._element),\n      ...(typeof config === 'object' ? config : {})\n    }\n\n    return config\n  }\n\n  _createSpinner() {\n    if (this._config.spinner) {\n      const spinner = document.createElement('span')\n      const type = this._config.spinnerType\n      spinner.classList.add(CLASS_NAME_LOADING_BUTTON_SPINNER, `spinner-${type}`, `spinner-${type}-sm`)\n      spinner.setAttribute('role', 'status')\n      spinner.setAttribute('aria-hidden', 'true')\n      this._element.insertBefore(spinner, this._element.firstChild)\n      this._spinner = spinner\n    }\n  }\n\n  _removeSpinner() {\n    if (this._config.spinner) {\n      this._spinner.remove()\n      this._spinner = null\n    }\n  }\n\n  // Static\n\n  static loadingButtonInterface(element, config) {\n    const data = LoadingButton.getOrCreateInstance(element, config)\n\n    if (typeof config === 'string') {\n      if (typeof data[config] === 'undefined') {\n        throw new TypeError(`No method named \"${config}\"`)\n      }\n\n      data[config]()\n    }\n  }\n\n  static jQueryInterface(config) {\n    return this.each(function () {\n      LoadingButton.loadingButtonInterface(this, config)\n    })\n  }\n}\n\n/**\n * ------------------------------------------------------------------------\n * jQuery\n * ------------------------------------------------------------------------\n * add .LoadingButton to jQuery only if jQuery is present\n */\n\ndefineJQueryPlugin(LoadingButton)\n\nexport default LoadingButton\n"],"names":["NAME","DATA_KEY","EVENT_KEY","EVENT_START","EVENT_STOP","CLASS_NAME_IS_LOADING","CLASS_NAME_LOADING_BUTTON_SPINNER","Default","disabledOnLoading","spinner","spinnerType","timeout","DefaultType","LoadingButton","BaseComponent","constructor","element","config","_config","_getConfig","_timeout","_spinner","_state","_element","Data","set","start","_createSpinner","setTimeout","classList","add","EventHandler","trigger","setAttribute","stop","remove","stoped","_removeSpinner","removeAttribute","_queueCallback","dispose","removeData","Manipulator","getDataAttributes","document","createElement","type","insertBefore","firstChild","loadingButtonInterface","data","getOrCreateInstance","TypeError","jQueryInterface","each","defineJQueryPlugin"],"mappings":"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"}