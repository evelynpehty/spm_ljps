<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>View All Roles</title>

    <link rel = "stylesheet" href = "">

    <link href='https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css'
    rel='stylesheet'
    integrity='sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC'
    crossorigin='anonymous'>

    <script
       src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js">
    </script>

</head>
<body>
    <div id = "main-container" class = "container">
        <h1 clas = "display-4">Available Organizational Roles</h1> 
        <table id = "rolesTable" class = "table table-striped" border = "1">
            <thead class = "thead-dark">
                <tr>
                    <th>Role Title</th>
                    <th>Role Description</th>
                </tr>
            </thead>
        </table>
    </div>

    <script>
        function showError(message){
            $("#rolesTable").hide();
            $("main-container").append(
                "<label>"+message+"</label>"
            );
        }

        $(async()=>{
            var serviceURL = "http://127.0.0.1:5000/api/staff/jack.sim@allinone.com.sg";
            try {
                const response = 
                await fetch(
                    serviceURL, {method: "GET"}
                );
                const result = await response.json();
                if (response.status == 200){
                    var roles = result.data.Job_Role_List;
                    var rows = "";
                    // TO EDIT DEPENDING ON DATABASE //
                    for (const role of roles){
                        eachRow = "<td>" + role.title + "</td>" +  "<td>" + role.desc + "</td>";
                        rows += "<tr>" + eachRow + "</tr>";
                    }
                    $("#rolesTable").append(rows);
                }
            else if (response.status == 404){
                showError(result.message)
            }
            else {
                throw response.status
            }
        }
        catch (error){
            showError(
                "There was a problem retrieving roles data, please try again later.<br/>" + error
            );
        }
            
        });
    </script>

    <script 
       src='https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js'
       integrity='sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM'
       crossorigin='anonymous'></script>
    
</body>
</html>